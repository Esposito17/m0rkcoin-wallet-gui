<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <title>M0rkcoin Wallet</title>
    <link href="assets/css/global.css" rel="stylesheet">
    <link href="assets/css/photon.min.css" rel="stylesheet">
</head>
<body>

<div class="main-container">

    <div class="app-sidebar">
        <h1>M0rkcoin</h1>
        <p>
            <span class="small-label"><span class="icon icon-network"></span> Wallet address</span><br>
            <span id="walletAddress" style="word-break: break-all">N/A</span>
            <span id="copyWalletAddress" class="text-btn text-btn-small">COPY</span>
        </p>
        <p>
            <span class="small-label"><span class="icon icon-credit-card"></span> Available Balance</span><br>
            <span id="walletBalanceAvail">N/A</span><br>
            <span class="small-label"><span class="icon icon-lock"></span> Locked</span><br>
            <span id="walletBalanceLocked">N/A</span>
        </p>
    </div>

    <input class='hide' type="radio" id="tab-1" name="tractor"/>
    <label for='tab-1' class="label-tab">Send</label>

    <article class='tab-1' id="tab-send">

    </article>

    <input class='hide' type="radio" id="tab-2" name="tractor"/>
    <label for='tab-2' class="label-tab">Transactions</label>

    <article class='tab-2' id="tab-transactions">

    </article>

    <input class='hide' type="radio" id="tab-3" name="tractor" checked='checked'/>
    <label for='tab-3' class="label-tab">Logs</label>

    <article class='tab-3' id="tab-logs">
        <div>
            <label for="daemonConsole">Daemon Logs:</label>
            <textarea style="width: 100%; height: 240px" readonly id="daemonConsole"></textarea>
        </div>
    </article>
</div>

<script>
    // Init
    const electron = require('electron');
    const {ipcRenderer, clipboard} = electron;

    const daemonConsole = document.querySelector('#daemonConsole');
    const walletConsole = document.querySelector('#walletConsole');

    let walletReady = false;

    // UI Interactions
    const copyWalletAddressBtn = document.querySelector("#copyWalletAddress");
    copyWalletAddressBtn.addEventListener('click', () => {
        clipboard.writeText(document.querySelector('#walletAddress').textContent)
    });

    // Events Out


    // Events In
    ipcRenderer.on('daemonUpdate', (event, data) => {
        console.log('got daemon update: ' + data.message);
        daemonConsole.value += data.message;
        daemonConsole.scrollTop = daemonConsole.scrollHeight;
    });

    ipcRenderer.on('walletUpdate', (event, data) => {
        console.log('got wallet update: ' + data.message);
        walletConsole.value += data.message;
        walletConsole.scrollTop = walletConsole.scrollHeight;
    });

    ipcRenderer.on('walletReady', (event, data) => {
        walletReady = data.walletReady;
        document.querySelector('#walletSendCommandBtn').disabled = !walletReady
    });

    ipcRenderer.on('walletAddress', (event, data) => {
        document.querySelector('#walletAddress').textContent = data.address;
    });

    ipcRenderer.on('walletBalance', (event, data) => {
        let available = Number.parseFloat(data.available / 1000000000000).toFixed(12);
        let locked = Number.parseFloat(data.locked / 1000000000000).toFixed(12);
        document.querySelector('#walletBalanceAvail').textContent = available;
        document.querySelector('#walletBalanceLocked').textContent = locked;
    });

</script>
</body>
</html>